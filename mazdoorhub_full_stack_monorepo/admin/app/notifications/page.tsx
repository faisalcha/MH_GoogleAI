'use client'; import {useEffect,useState} from 'react'; import {ApiBar,useApiBase} from '../../components/common'; export default function Page(){const api=useApiBase(); const [tpls,setTpls]=useState<any>({whatsapp:[],push:[]}); const [tpl,setTpl]=useState('reference_request'); const [to,setTo]=useState('+923001234567'); const [params,setP]=useState('{"name":"Ahmad","link":"https://mh.app/ref?token=abc"}'); const [msg,setMsg]=useState(''); useEffect(()=>{ fetch(api+'/notifications/templates').then(r=>r.json()).then(setTpls).catch(()=>{}); },[api]); const enqueue=async()=>{ const body={channel:'whatsapp',template_key:tpl,to_phone:to,params:JSON.parse(params)}; const r=await fetch(api+'/notifications/enqueue',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(body)}); setMsg(JSON.stringify(await r.json())); }; return (<div style={{padding:20}}><ApiBar title='Notifications'/><div>Templates: {tpls.whatsapp?.join(', ')}</div><input value={tpl} onChange={e=>setTpl(e.target.value)} /><input value={to} onChange={e=>setTo(e.target.value)} /><textarea rows={6} value={params} onChange={e=>setP(e.target.value)} style={{width:'100%'}}/><button onClick={enqueue}>Enqueue</button><pre>{msg}</pre></div>); }